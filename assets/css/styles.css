/**
 * Hum Studios | Refactored Stylesheet
 *
 * Version: 3.2.0 (FINAL, Corrected)
 * Date: 2025-08-30
 *
 * Description:
 * A complete and visually accurate refactoring. This version resolves all
 * previously identified regressions in functionality, spacing, icon rendering,
 * and colour schemes, ensuring a pixel-perfect match to the original design
 * while maintaining a clean, token-driven, mobile-first structure.
 */

/* =====================================================================
   00. WEBFONTS (Overpass + Atma)
   - Paths are relative to this file (/assets/css/): use ../fonts/
   - Files expected at /assets/fonts/: Atma-Bold-700.woff2, Overpass-Regular-400.woff2,
     Overpass-Italic-400.woff2, Overpass-Medium-500.woff2, Overpass-SemiBold-600.woff2
   ===================================================================== */
@font-face {
  font-family: "Overpass";
  src: local("Overpass Regular"), local("Overpass-Regular"),
       url("../fonts/Overpass-Regular-400.woff2") format("woff2");
  font-weight: 400;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: "Overpass";
  src: local("Overpass Italic"), local("Overpass-Italic"),
       url("../fonts/Overpass-Italic-400.woff2") format("woff2");
  font-weight: 400;
  font-style: italic;
  font-display: swap;
}

@font-face {
  font-family: "Overpass";
  src: local("Overpass Medium"), local("Overpass-Medium"),
       url("../fonts/Overpass-Medium-500.woff2") format("woff2");
  font-weight: 500;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: "Overpass";
  src: local("Overpass SemiBold"), local("Overpass-SemiBold"),
       url("../fonts/Overpass-SemiBold-600.woff2") format("woff2");
  font-weight: 600;
  font-style: normal;
  font-display: swap;
}

@font-face {
  font-family: "Atma";
  src: local("Atma Bold"), local("Atma-Bold"),
       url("../fonts/Atma-Bold-700.woff2") format("woff2");
  font-weight: 700;
  font-style: normal;
  font-display: swap;
}

/* Mobile: hide desktop nav */
@media (max-width: 47.999em) {
  .top-nav { display: none !important; }
}



/* Stabilize layout width when vertical scrollbar appears (no left gutter) */
html { scrollbar-gutter: stable; }



/* =====================================================================
   01. TOKENS (CSS Custom Properties)
   ===================================================================== */
:root {
  /* Color Palette */
  --gradient-start: #235b98;
  --gradient-mid: #4891c3;
  --gradient-end: #2d69a3;
  --text-strong: #0b1220;
  --text-muted: #475569;
  --text-glow: #4a90e2;
  --nav-link: #FFFCF5;
  --light-card-bg: #FFFCF5;
  --light-card-alt-bg: #FFF8ED;
  --light-card-border: #e5ecf6;
  --light-card-fg: #0b1220;
  --color-heading: #004080;
  --accent: #2563eb;
  --accent-warm: #f6c64b;
  --accent-warm-ink: #2b1f05;
  --focus-ring: #4f46e5;

  /* Typography */
  --font-sans: 'Overpass', system-ui, -apple-system, Segoe UI, Roboto, sans-serif;
  --font-display: 'Atma', cursive;
  --font-size-base: 1rem;
  --font-size-body: 1rem;
  --font-size-small: 0.875rem;
  --font-size-xs: 0.7rem;

  /* Fluid Type Scale */
  --font-size-nav: clamp(1rem, 0.8vw + 0.9rem, 1.25rem);
  --font-size-h3: clamp(1.125rem, 2.5vw + 0.7rem, 1.5rem);
  --font-size-h2: clamp(1.2rem, 4.5vw + 0.2rem, 1.7rem);
  --font-size-h1: clamp(1.2rem, 4.5vw + 0.2rem, 1.7rem);
  --font-size-hero: clamp(2.2rem, 5.5vw + 0.5rem, 3.6rem);

  /* Sizing & Radii */
  --content-max: 960px;
  --measure: 66ch;
  --radius-card: 1.5em;
  --radius-small: 0.5em;
  --radius-xs: 0.25em;

  /* Spacing Scale */
  --space-0: 0;
  --space-1: 0.25em;
  --space-2: 0.5em;
  --space-3: 0.75em;
  --space-4: 1em;
  --space-5: 1.25em;
  --space-6: 1.5em;
  --space-8: 2em;
  --space-10: 2.5em;
  --space-12: 3em;
  --space-16: 4em;
  --space-20: 5em;
  --space-24: 6em;

  /* Layout Spacing */
  --stack-gap: var(--space-6);
  --card-gap: var(--stack-gap);
  --paragraph-gap: var(--space-4);
  --media-gap: var(--space-4);
  --hero-gap-top: clamp(2rem, calc(1rem + 2.9vw), 3.5rem);
  --hero-gap-bottom: var(--space-2);
  --container-padding-x: var(--space-4);
  --container-padding-y: var(--space-8);
  --container-padding-bottom: var(--space-10);

  /* Component Tokens */
  --logo-width-min: 7.5em;
  --logo-width-max: 8em;
  --hamburger-size: 1.8em;
  --hamburger-bar-height: 0.21em;
  --hamburger-gap: 0.3125em;
  --min-touch-target: 2.75em;
  --cartoon-scale: 0.90;
  
  /* --- Navigation Icons --- */
  --nav-icon-size: 1.1em; --nav-icon-gap: 0.3em; --nav-icon-nudge-y: -0.13em;
  --icon-home: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 3l9 7v11h-6v-6H9v6H3V10l9-7z"/></svg>');
  --icon-user: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 12c-4.418 0-8 3.134-8 7v1h16v-1c0-3.866-3.582-7-8-7zm0-2a4 4 0 100-8 4 4 0 000 8z"/></svg>');
  --icon-bubble: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 4h16v10H7l-3 4V4z"/></svg>');
  --icon-shield: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2l8 4v6c0 5-3.5 9.5-8 10-4.5-.5-8-5-8-10V6l8-4z"/></svg>');
  --icon-cookie: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><circle cx="9" cy="9.5" r="1.2"/><circle cx="15" cy="9.3" r="1.2"/><circle cx="12.5" cy="13.5" r="1.2"/><path d="M21 12a9 9 0 01-9 9 9 9 0 110-18c.4 1.9 1.7 3 3 3 0 1.6 1.4 3 3 3 0 1.6 1.4 3 3 3z"/></svg>');

  /* Polish & Effects */
  --shadow-1: 0 0.25em 0.6em rgba(11, 18, 32, 0.08), 0 0.6em 1.6em rgba(11, 18, 32, 0.06);
  --shadow-1-hover: 0 0.5em 1.2em rgba(11, 18, 32, 0.10), 0 1.1em 2.2em rgba(11, 18, 32, 0.08);
  --shadow-2: 0 0.75em 1.8em rgba(11, 18, 32, 0.14), 0 1.4em 3em rgba(11, 18, 32, 0.10);
  --underline-offset: 0.18em;
  --underline-thickness: 0.08em;
  --clouds-opacity: 0.4;
  --transition-fast: 0.15s;
  --transition-normal: 0.25s;
  --transition-slow: 0.35s;
  --transition-ease: ease;

  /* Z-Index Scale */
  --z-clouds: 0;
  --z-body: 1;
  --z-header: 10;
  --z-nav-mobile: 50;
  --z-toggle: 100;
  --z-popover: 1000;

  color-scheme: light;
}

/* --- Responsive Token Overrides --- */
@media (max-width: 35em) {
  :root {
    --gradient-start: #2b6fb0;
    --gradient-mid: #5aa2cf;
    --gradient-end: #3a7ab4;
  }
}
@media (min-width: 25em) { :root { --logo-width-max: 10em; } }
@media (min-width: 40em) { :root { --container-padding-x: var(--space-5); --radius-card: 2rem; } }
@media (min-width: 48em) {
  :root {
    --stack-gap: var(--space-8);
    --container-padding-x: var(--space-6);
    --radius-card: 2rem;
    --font-size-hero: clamp(3.25rem, 5vw + 1.25rem, 5.25rem);
    --font-size-h1: clamp(1.6rem, 1.5vw + 1rem, 2.25rem);
    --font-size-h2: clamp(1.6rem, 1.5vw + 1rem, 2.25rem);
    --font-size-body: clamp(1rem, 0.5vw + 0.9rem, 1.125rem);
    --paragraph-gap: var(--space-4);
    --media-gap: var(--space-6);
  }
}
@media (min-width: 80em) {
  :root {
    --container-padding-x: var(--space-8);
    --font-size-hero: clamp(3.5rem, 3vw + 2rem, 5.5rem);
  }
}

/* =====================================================================
   02. GLOBAL & BASE STYLES
   ===================================================================== */
html {
  background: linear-gradient(to bottom, var(--gradient-start), var(--gradient-mid), var(--gradient-end));
  background-size: 160% 160%;
  background-attachment: fixed;
  font-size: var(--font-size-base);
  scroll-behavior: smooth;
  animation: hum-gradient-drift 60s ease-in-out infinite;
}
body {
  position: relative;
  display: flex;
  flex-direction: column;
  min-height: 100vh;
  margin: 0;
  overflow-x: hidden;
  font-family: var(--font-sans);
  font-size: var(--font-size-body);
  color: var(--text-strong);
  background: transparent;
  line-height: 1.3;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}
@supports (-webkit-overflow-scrolling: touch) {
  html { background: none; }
  body::before {
    content: "";
    position: fixed;
    inset: 0;
    z-index: -1;
    pointer-events: none;
    background: linear-gradient(to bottom, var(--gradient-start), var(--gradient-mid), var(--gradient-end));
  }
}
@keyframes hum-gradient-drift {
  0%   { background-position: 0% 0%; }
  50%  { background-position: 100% 100%; }
  100% { background-position: 0% 0%; }
}
* { box-sizing: border-box; }
img, svg, video { max-width: 100%; height: auto; display: block; }
:focus-visible {
  outline: 0.125em solid var(--focus-ring);
  outline-offset: 0.125em;
  border-radius: var(--radius-xs);
}

/* Dark mode: contact button colour (minimal) */
[data-theme="dark"] .btn {
background: #2B245A; /* pick any colour */
color: #e6edf7;      /* ensure readable text */
}

/* =====================================================================
   03. LAYOUT & STRUCTURE
   ===================================================================== */
.container {
  flex: 1;
  display: flex;
  flex-direction: column;
  position: relative;
  z-index: var(--z-body);
  width: min(var(--content-max), 95%);
  margin-inline: auto;
  padding: var(--container-padding-y) var(--container-padding-x) var(--container-padding-bottom);
  container-type: inline-size;
}
body.loading .container { visibility: hidden; }
body:not(.loading) .container { /* animation disabled on swaps; see first-load scope below */ }

/* Animate the container only on the very first full page load (not on Turbo swaps) */
body.first-load .container { animation: fadeInLayout var(--transition-normal) ease-in; }
body:not(.first-load) .container { animation: none; }
@keyframes fadeInLayout {
  from { opacity: 0; transform: translateY(0.625em); }
  to   { opacity: 1; transform: translateY(0); }
}
.top-header {
  position: relative;
  display: flex;
  justify-content: space-between;
  align-items: flex-end;
  flex-wrap: wrap;
  margin-bottom: var(--hero-gap-top);
  z-index: var(--z-header);
  column-gap: var(--space-2);
}
.logo { display: block; width: clamp(var(--logo-width-min), 8vw, var(--logo-width-max)); height: auto; }
.logo img {
  display: block;
  transform-origin: center center;
  filter: drop-shadow(0 4px 14px rgba(255, 255, 245, 0.3)) drop-shadow(0 0 8px rgba(255, 255, 245, 0.45));
  transition: transform var(--transition-normal) var(--transition-ease),
              filter var(--transition-normal) var(--transition-ease);
}
@media (min-width: 48em) and (hover: hover) and (pointer: fine) {
  .logo:hover img,
  .logo:focus-visible img {
    transform: scale(1.2);
    filter: drop-shadow(0 4px 18px rgba(255, 255, 245, 0.4)) drop-shadow(0 0 10px rgba(255, 255, 245, 0.45));
  }
}
footer {
  position: relative;
  z-index: var(--z-body);
  margin-top: auto;
  padding: var(--space-4) var(--container-padding-x) var(--space-6);
  color: var(--nav-link);
  font-family: var(--font-sans);
  background-image: linear-gradient(to bottom, var(--gradient-end), #1a1747);
}
footer::before {
  content: "";
  position: absolute;
  top: 0; left: 0; right: 0;
  height: 0.125em;
  opacity: 0.6;
  pointer-events: none;
  background: linear-gradient(to right, rgba(255,255,255,0.15), rgba(255,255,255,0.0), rgba(255,255,255,0.15));
}
.footer-inner {
  display: flex;
  flex-direction: column;
  align-items: center;
  gap: var(--space-1);
  max-width: var(--content-max);
  width: 100%;
  margin-inline: auto;
}
.footer-nav { width: 100%; }
.footer-links {
  display: flex;
  justify-content: center;
  align-items: center;
  gap: clamp(var(--space-1), 4.5vw, var(--space-4));
  margin: 0;
  padding: 0;
  list-style: none;
  font-weight: 600;
  font-size: clamp(0.9rem, 0.85rem + 0.3vw, 1rem);
}
.footer-links a {
  display: flex;
  align-items: center;
  justify-content: center;
  padding: var(--space-2);
  min-height: var(--min-touch-target);
  color: inherit;
  text-decoration: none;
  border-radius: var(--radius-xs);
  transition: all var(--transition-normal) var(--transition-ease);
}
.footer-social {
  display: flex;
  align-items: center;
  justify-content: center;
  gap: var(--space-2);
  flex-wrap: wrap;
}
.footer-social a {
  display: inline-flex;
  align-items: center;
  justify-content: center;
  padding: var(--space-1);
  min-width: var(--min-touch-target);
  min-height: var(--min-touch-target);
  border-radius: var(--radius-xs);
  transition: background-color var(--transition-normal) var(--transition-ease);
}
.footer-links a:hover, .footer-links a:focus-visible,
.footer-social a:hover, .footer-social a:focus-visible {
  text-decoration: underline;
  background-color: rgba(255, 255, 255, 0.1);
}
.footer-social img { width: clamp(2.75em, 4.6vw, 3em); height: auto; filter: drop-shadow(0 0.0625em 0.0625em rgba(0,0,0,0.12)); }
.footer-legal { text-align: center; font-size: var(--font-size-xs); line-height: 1.3; margin-top: var(--space-3); }
.footer-legal p { margin: 0.2em 0; }
.registered-address { display: none; font-style: normal; }
body.contact-page .registered-address { display: block; }

/* =====================================================================
   04. COMPONENTS
   ===================================================================== */
.clouds {
  position: fixed;
  inset: 0;
  width: 100vw;
  pointer-events: none;
  overflow: hidden;
  opacity: var(--clouds-opacity);
  z-index: var(--z-clouds);
}
.cloud { position: absolute; will-change: transform; animation: cloud-drift var(--duration) linear infinite var(--delay); }
@keyframes cloud-drift { from { transform: translateX(var(--from, -20vw)); } to   { transform: translateX(var(--to, 120vw)); } }
.cloud1 { top: 2.3%; left: -15vw; width: 10em;   --from: -20vw; --to: 110vw; --delay: -17s; --duration: 90s; }
.cloud2 { top: 20%;  left: -2vw;  width: 8.5em;  --from: -12vw; --to: 160vw; --delay: -35s; --duration: 75s; }
.cloud3 { top: 29%;  left: -8vw;  width: 7.5em;  --from: -8vw;  --to: 140vw; --delay: -5s;  --duration: 67s; }
.cloud4 { top: 42%;  left: -5vw;  width: 9em;    --from: -5vw;  --to: 105vw; --delay: -33s; --duration: 83s; }
.cloud5 { top: 57%;  left: -12vw; width: 7.5em;  --from: -12vw; --to: 160vw; --delay: -25s; --duration: 67s; }
.cloud6 { top: 72%;  left: -12vw; width: 7em;    --from: -8vw;  --to: 140vw; --delay: -55s; --duration: 55s; }
.cloud7 { top: 87%;  left: -20vw; width: 9em;    --from: -20vw; --to: 120vw; --delay: -30s; --duration: 83s; }
@media (min-width: 48em) {
  .cloud1 { width: 12.5em;  --duration: 180s; } .cloud2 { width: 10.625em; --duration: 140s; } .cloud3 { width: 9.375em; --duration: 105s; }
  .cloud4 { width: 11.25em;  --duration: 165s; } .cloud5 { width: 9.375em; --duration: 135s; } .cloud6 { width: 8.75em;  --duration: 110s; }
  .cloud7 { width: 11.25em;  --duration: 165s; }
}
@media (min-width: 80em) { .clouds { opacity: calc(var(--clouds-opacity) - 0.05); } }

/* --- Navigation --- */
.hamburger {
  display: flex; flex-direction: column; justify-content: center;
  gap: var(--hamburger-gap); padding: 0.5em; cursor: pointer; z-index: var(--z-nav-mobile);
  background-color: rgba(0,0,0,0.1); border: 0.0625em solid rgba(0,0,0,0.2); border-radius: var(--radius-xs);
  transition: all var(--transition-normal) var(--transition-ease);
}
.hamburger:hover, .hamburger:focus-visible { background-color: color-mix(in srgb, #ffffff 18%, transparent); }
.hamburger .bar {
  width: var(--hamburger-size); height: var(--hamburger-bar-height); background-color: var(--nav-link);
  display: block; border-radius: 0.0625em; transition: all var(--transition-normal) var(--transition-ease);
}
.mobile-nav { display: none; }
.top-nav a, .mobile-nav a {
  display: flex; align-items: center; min-height: var(--min-touch-target); padding: var(--space-2);
  font-family: var(--font-sans); font-weight: 500; font-size: var(--font-size-nav); color: var(--nav-link);
  text-decoration: none; border-radius: var(--radius-xs); letter-spacing: 0.02em;
  text-underline-offset: var(--underline-offset); text-decoration-thickness: var(--underline-thickness);
  transition: all var(--transition-normal) var(--transition-ease); gap: var(--nav-icon-gap, 0.3em);
}
.top-nav a, .mobile-nav:not(:is(.pushdown, [data-behavior="pushdown"])) a {
  text-shadow: 0 2px 6px rgba(10, 10, 90, 0.65), 0 0 4px rgba(10, 10, 90, 0.45);
}
.mobile-nav {
  position: absolute; right: 0; top: calc(100% + var(--space-2)); z-index: var(--z-popover);
  min-width: 12em; padding: var(--space-4); gap: var(--space-2); text-align: right; flex-direction: column;
  background: var(--light-card-bg); border: 0.0625em solid var(--light-card-border);
  border-radius: var(--radius-small); box-shadow: 0 0.5em 1.5em rgba(0,0,0,0.15);
}
.mobile-nav:is(.show, [open]) { display: flex !important; }
.mobile-nav a { justify-content: flex-end; padding: var(--space-3); color: var(--text-strong); }
.mobile-nav a:hover, .mobile-nav a:focus-visible { text-decoration: underline; background-color: rgba(37, 91, 152, 0.1); }
.mobile-nav:is(.pushdown, [data-behavior="pushdown"]) {
  position: static; display: flex; flex: 0 0 100%; width: 100%; max-height: 0; overflow: hidden;
  margin-top: 0; pointer-events: none; background: transparent; border: 0; box-shadow: none; padding: 0; text-align: center;
  transition: max-height var(--transition-slow) var(--transition-ease), margin-top var(--transition-fast) var(--transition-ease);
}
.mobile-nav:is(.pushdown, [data-behavior="pushdown"]):is(.show, [open]) { max-height: 60vh; margin-top: var(--space-2); pointer-events: auto; }
.mobile-nav:is(.pushdown, [data-behavior="pushdown"]) a {
  color: var(--nav-link); justify-content: center; border-bottom: 0.0625em solid rgba(255, 252, 245, 0.3);
}
.mobile-nav:is(.pushdown, [data-behavior="pushdown"]) a:last-child { border-bottom: none; }
.mobile-nav:is(.pushdown, [data-behavior="pushdown"]) a:hover { background: transparent; }
@media (min-width: 48em) {
  .hamburger, .mobile-nav { display: none !important; }
  .top-nav { display: flex; gap: var(--space-4); }
  .top-nav a { padding: var(--space-6) var(--space-2) var(--space-0); }
  .top-nav a:hover, .top-nav a:focus-visible { text-decoration: underline; background-color: transparent; }
}

/* Base styles applied ONLY to links that have an icon */
.top-nav a.home::before, .mobile-nav a.home::before, .top-nav a[data-nav="home"]::before, .mobile-nav a[data-nav="home"]::before, .top-nav a[data-nav="home" i]::before, .mobile-nav a[data-nav="home" i]::before,
.top-nav a[href="/"]::before, .mobile-nav a[href="/"]::before, .top-nav a[href$="index"]::before, .mobile-nav a[href$="index"]::before,.top-nav a[href$="index.html"]::before, .mobile-nav a[href$="index.html"]::before, 
.top-nav a[href*="home" i]::before, .mobile-nav a[href*="home" i]::before, .top-nav a[href*="about" i]::before, .mobile-nav a[href*="about" i]::before,
.top-nav a[data-nav="home" i]::before, .mobile-nav a[data-nav="home" i]::before, .top-nav a[href$="index.html"]::before, .mobile-nav a[href$="index.html"]::before,
.top-nav a.index::before, .mobile-nav a.index::before, .top-nav a[data-nav="index"]::before, .mobile-nav a[data-nav="index"]::before, .top-nav a[data-nav="index" i]::before, .mobile-nav a[data-nav="index" i]::before,
.top-nav a[data-nav="about"]::before, .mobile-nav a[data-nav="about"]::before, .top-nav a[href*="contact" i]::before, .mobile-nav a[href*="contact" i]::before,
.top-nav a[data-nav="contact"]::before, .mobile-nav a[data-nav="contact"]::before, .top-nav a[href*="privacy" i]::before, .mobile-nav a[href*="privacy" i]::before,
.top-nav a[data-nav="privacy"]::before, .mobile-nav a[data-nav="privacy"]::before, .top-nav a[href*="cookie" i]::before, .mobile-nav a[href*="cookie" i]::before,
.top-nav a[data-nav="cookies"]::before, .mobile-nav a[data-nav="cookies"]::before {
  content: ""; display: inline-block; width: var(--nav-icon-size); height: var(--nav-icon-size);
  background-color: var(--accent-warm); margin-right: var(--nav-icon-gap);
  transform: translateY(var(--nav-icon-nudge-y));
}
/* Home icon mask (simplified) */
.top-nav a:is(.home,
              .index,
              [data-nav="home" i],
              [data-nav="index" i],
              [href="/"],
              [href$="index"],
              [href$="index.html"],
              [href*="home" i])::before,
.mobile-nav a:is(.home,
                 .index,
                 [data-nav="home" i],
                 [data-nav="index" i],
                 [href="/"],
                 [href$="index"],
                 [href$="index.html"],
                 [href*="home" i])::before {
  -webkit-mask: var(--icon-home) no-repeat 50% / contain;
  mask: var(--icon-home) no-repeat 50% / contain;
}

.top-nav a[href*="about" i]::before, .mobile-nav a[href*="about" i]::before, .top-nav a[data-nav="about"]::before, .mobile-nav a[data-nav="about"]::before { -webkit-mask: var(--icon-user) no-repeat 50% / contain; mask: var(--icon-user) no-repeat 50% / contain; }
.top-nav a[href*="contact" i]::before, .mobile-nav a[href*="contact" i]::before, .top-nav a[data-nav="contact"]::before, .mobile-nav a[data-nav="contact"]::before { -webkit-mask: var(--icon-bubble) no-repeat 50% / contain; mask: var(--icon-bubble) no-repeat 50% / contain; }
.top-nav a[href*="privacy" i]::before, .mobile-nav a[href*="privacy" i]::before, .top-nav a[data-nav="privacy"]::before, .mobile-nav a[data-nav="privacy"]::before { -webkit-mask: var(--icon-shield) no-repeat 50% / contain; mask: var(--icon-shield) no-repeat 50% / contain; }
.top-nav a[href*="cookie" i]::before, .mobile-nav a[href*="cookie" i]::before, .top-nav a[data-nav="cookies"]::before, .mobile-nav a[data-nav="cookies"]::before { -webkit-mask: var(--icon-cookie) no-repeat 50% / contain; mask: var(--icon-cookie) no-repeat 50% / contain; }
:dir(rtl) .top-nav a[href*="home" i]::before, :dir(rtl) .mobile-nav a[href*="home" i]::before { margin-left: var(--nav-icon-gap); margin-right: 0; }


/* --- iOS Safari pushdown menu blue-line fix (touch-only) -------------------
   Prevents the transient blue underline that appears after tapping a nav link
   on iPhone by neutralizing focus/active decorations on *touch* devices only.
   Keyboard users (desktop) still see proper :focus-visible styles.
---------------------------------------------------------------------------- */
.top-nav a,
.mobile-nav a {
  -webkit-tap-highlight-color: transparent;
}
@media (hover: none) and (pointer: coarse) {
  .top-nav a:focus,
  .top-nav a:active,
  .mobile-nav a:focus,
  .mobile-nav a:active,
  .mobile-nav:is(.pushdown, [data-behavior="pushdown"]) a:focus,
  .mobile-nav:is(.pushdown, [data-behavior="pushdown"]) a:active {
    outline: none !important;
    box-shadow: none !important;
    text-decoration: none !important;
    border: 0 !important;
    background: transparent !important;
  }
  .top-nav a:focus::after,
  .top-nav a:active::after,
  .mobile-nav a:focus::after,
  .mobile-nav a:active::after {
    content: none !important;
  }
}

/* --- Hero Section --- */
.hero-headline {
  max-width: 28ch; margin: 0 auto var(--hero-gap-bottom); font-family: var(--font-display); font-size: var(--font-size-hero);
  font-weight: 700; text-align: center; line-height: 1.1; color: var(--nav-link);
  text-shadow: 0.125em 0.125em 0.25em #443A86; text-wrap: balance;
}
@supports (font-size: 1cqw) { .hero-headline { font-size: clamp(2rem, 6.5cqw, 3.2rem); } }
.hero-subheadline {
  max-width: 42ch; margin: var(--space-2) auto var(--space-3); font-family: var(--font-sans); font-weight: 500;
  font-size: clamp(1rem, 1.2vw + 0.9rem, 1.25rem); color: var(--nav-link); opacity: 0.98; text-align: center;
  text-shadow: 0 0.12em 0.35em rgba(10, 10, 30, 0.45);
}
.hero-image { position: relative; isolation: isolate; overflow: hidden; }
.hero-image::after {
  content: ""; position: absolute; inset: 0; pointer-events: none; mix-blend-mode: multiply;
  background: linear-gradient( to bottom, rgba(0,0,0,0.18) 0%, transparent 22%, transparent 78%, rgba(0,0,0,0.22) 100% );
}
#adventureVideo { margin-bottom: var(--space-4); }

/* --- Typography --- */
h1, h2, h3 { color: var(--color-heading); font-family: var(--font-display); font-weight: 700; text-align: center; line-height: 1.2; text-wrap: balance; margin: 0; }
h1 { font-size: var(--font-size-h1); } h2 { font-size: var(--font-size-h2); } h3 { font-size: var(--font-size-h3); }
.card p, .card ul, .card ol { max-width: var(--measure); margin-left: auto; margin-right: auto; line-height: 1.5; }
@media (min-width: 48em) { body { line-height: 1.45; } .card p, .card ul, .card ol { line-height: 1.6; } }
.card p { margin-block-end: var(--paragraph-gap); }
.card p:last-child { margin-block-end: 0; }
/* List rhythm to match paragraphs */
.card :is(ul, ol) { margin-block-end: var(--paragraph-gap); }
.card :is(ul, ol):last-child { margin-block-end: 0; }
.card a { color: var(--accent); overflow-wrap: break-word; text-underline-offset: var(--underline-offset); text-decoration-thickness: var(--underline-thickness); transition: color var(--transition-normal) var(--transition-ease); }
.card a:hover, .card a:focus-visible { color: color-mix(in srgb, var(--accent) 80%, black); }

/* Media rhythm — images & videos inside cards */
.card :is(img.card-cartoon, video.demo-video, .demo-video, #adventureVideo, iframe) {
  margin-block: var(--media-gap);
}

/* Media adjacency spacing */
.card :is(h1, h2, h3) + :is(img.card-cartoon, video.demo-video, .demo-video, #adventureVideo, iframe) { margin-block-start: var(--space-3); }
.card p + :is(img.card-cartoon, video.demo-video, .demo-video, #adventureVideo, iframe) { margin-block-start: var(--space-4); }
.card :is(img.card-cartoon, video.demo-video, .demo-video, #adventureVideo, iframe) + p { margin-block-start: var(--space-4); }
.card :is(img.card-cartoon, video.demo-video, .demo-video, #adventureVideo, iframe) + :is(h1, h2, h3) { margin-block-start: var(--space-4); }

/* First-child text spacing if a card starts with body content */
.card > :is(p, ul, ol):first-child { margin-top: var(--space-2); }
@media (max-width: 30em) { .hero-headline { font-size: clamp(1.9rem, 7vw + 0.4rem, 2.6rem); } }
@media (max-width: 22.5em) {
  h1 { font-size: clamp(1.5rem, 6vw, 2.2rem); } h2 { font-size: clamp(1.3rem, 5.5vw, 1.9rem); }
  h3 { font-size: clamp(1.1rem, 5vw, 1.6rem); } .hero-headline { font-size: clamp(2rem, 8.5vw, 3rem); }
}
@container (max-width: 35em) {
  .card :where(h1,h2,h3) { line-height: 1.2; max-inline-size: 100%; }
  .card h1 { font-size: clamp(1.4rem, 5.2cqi + 0.2rem, 2.2rem); } .card h2 { font-size: clamp(1.2rem, 4.8cqi + 0.2rem, 1.9rem); }
  .card h3 { font-size: clamp(1.1rem, 4.2cqi + 0.2rem, 1.6rem); }
}

/* --- Cards --- */
.card {
  isolation: isolate; position: relative; border-radius: var(--radius-card); padding: var(--space-5) var(--space-6) var(--space-6);
  background: var(--light-card-bg); border: 0.0625em solid var(--light-card-border); box-shadow: var(--shadow-1);
  transition: transform var(--transition-normal) var(--transition-ease), box-shadow var(--transition-normal) var(--transition-ease);
}
@media (hover: hover) and (pointer: fine) { .card:hover { transform: translateY(-0.125em); box-shadow: var(--shadow-1-hover); } }
.card:nth-of-type(even):not(.card--hero-placeholder) { background: var(--light-card-alt-bg); }
.card::after {
  content: ""; position: absolute; inset: 0; z-index: 0; border-radius: inherit; pointer-events: none; opacity: 0.6;
  mix-blend-mode: multiply; background-image: radial-gradient(rgba(0,0,0,0.025) 1px, transparent 1.5px); background-size: 3px 3px;
}
.card > * { position: relative; z-index: 1; }
.card.card--hero-placeholder { padding: 0; background: transparent; border: 0; box-shadow: none; margin-top: var(--space-2); }
.card + .card { margin-top: var(--card-gap); }
.card > :is(h1, h2, h3):first-child { margin-top: var(--space-2); }
@media (min-width: 48em) {
  .card { padding: var(--space-6) var(--space-12); }
  .card > :is(h1, h2, h3):first-child { margin-top: var(--space-2); }
}
.card--has-float::after { content: ""; display: block; clear: both; }
.card-float { display: block; width: min(100%, 26.25em); margin: var(--space-4) auto; border-radius: var(--radius-small); border: 0.0625em solid var(--light-card-border); object-fit: contain; }
@media (min-width: 48em) {
  .card-float { width: min(35%, 16em); shape-outside: inset(0 round var(--radius-small)); shape-margin: 1em; }
  .card-float--left { float: left; margin: 0 var(--space-6) var(--space-4) 0; }
  .card-float--right { float: right; margin: 0 0 var(--space-4) var(--space-6); }
}
@media (min-width: 64em) { .card-float { width: min(40%, 18em); } }
.card-cartoon { max-height: clamp(calc(var(--cartoon-h-sm-min, 9em) * var(--cartoon-scale)), calc(var(--cartoon-h-sm-ideal, 12em) * var(--cartoon-scale)), calc(var(--cartoon-h-sm-max, 16em) * var(--cartoon-scale))); width: auto; margin: var(--space-4) auto; object-fit: contain; }
@media (min-width: 40em) { .card-cartoon { max-height: clamp(calc(var(--cartoon-h-lg-min, 11.25em) * var(--cartoon-scale)), calc(var(--cartoon-h-lg-ideal, 16em) * var(--cartoon-scale)), calc(var(--cartoon-h-lg-max, 20em) * var(--cartoon-scale))); } }
.download-row { display: flex; justify-content: center; align-items: center; gap: var(--space-3); flex-wrap: wrap; margin-top: var(--space-6); }
@media (min-width: 40em) { .download-row { gap: var(--space-4); } }
.download-row a {
  display: inline-flex; flex-direction: column; align-items: center; text-decoration: none; color: inherit;
}
.app-caption { margin-top: var(--space-2); font-size: var(--font-size-small); color: var(--text-strong); text-align: center; }
.textarea { resize: vertical; max-height: 60vh; }

/* --- Theme Toggle --- */
.theme-toggle {
  --transition-normal: 0.75s; --transition-slow: 0.90s; --ms-width: 3.25em; --ms-height: 1.78em; --ms-pad: -0.07em; --ms-thumb: 1.65em;
  --ms-left: var(--ms-pad); --ms-right: calc(var(--ms-width) - var(--ms-thumb) - var(--ms-pad) - 0.26em);
  position: absolute; top: calc(var(--space-4) * -1); right: 0; z-index: var(--z-toggle); display: inline-flex;
  align-items: center; justify-content: center; min-width: var(--min-touch-target); min-height: var(--min-touch-target);
  padding: var(--space-1); background: transparent; border: 0; cursor: pointer; color: var(--nav-link);
  border-radius: var(--radius-xs); -webkit-tap-highlight-color: transparent;
}
.theme-toggle:focus { outline: none; }
.theme-toggle:focus-visible { outline: 3px solid var(--focus-ring); outline-offset: 12px; border-radius: 16px; }
.theme-toggle__slider { position: relative; width: var(--ms-width); height: var(--ms-height); border-radius: 999em; border: 0.15em solid currentColor; background: transparent; transition: all var(--transition-normal) var(--transition-ease); }
.theme-toggle__thumb { position: absolute; top: 50%; left: 0; width: var(--ms-thumb); height: var(--ms-thumb); display: grid; place-items: center; border-radius: 999em; border: 0.15em solid currentColor; transform: translate(var(--ms-left), -50%); transition: transform var(--transition-normal) cubic-bezier(0.34, 1.56, 0.64, 1); }
html[data-theme="dark"] .theme-toggle__thumb { transform: translate(var(--ms-right), -50%); }
.theme-toggle__thumb::after { content: ""; position: absolute; inset: -6%; border-radius: inherit; border: 0.1em solid currentColor; opacity: 0; transform: scale(0.9); transition: transform 360ms cubic-bezier(0.34, 1.56, 0.64, 1), opacity 360ms var(--transition-ease); }
html[data-theme] .theme-toggle__thumb::after { opacity: 0.25; transform: scale(1.08); }
.theme-toggle__thumb svg { position: absolute; width: 1em; height: 1em; fill: none; stroke: currentColor; stroke-width: 0.15rem; stroke-linecap: round; stroke-linejoin: round; transform-origin: center; transition: all var(--transition-slow) var(--transition-ease); }
.theme-toggle__thumb .icon-sun  { opacity: 1; transform: rotate(0deg) scale(1); }
.theme-toggle__thumb .icon-moon { opacity: 0; transform: rotate(-90deg) scale(0.8); }
html[data-theme="dark"] .theme-toggle__thumb .icon-sun  { opacity: 0; transform: rotate(90deg) scale(0.8); }
html[data-theme="dark"] .theme-toggle__thumb .icon-moon { opacity: 1; transform: rotate(0deg) scale(1); }

/* =====================================================================
   05. UTILITY CLASSES
   ===================================================================== */
.u-center-text { text-align: center !important; }
.u-center-flex { display: flex !important; justify-content: center !important; align-items: center !important; gap: var(--space-2); flex-wrap: wrap; }
section + section { margin-top: var(--stack-gap); }
.list-disc-left { text-align: left !important; list-style: disc outside; padding-left: var(--space-6); max-width: 28em; margin-inline: auto; }
@media (min-width: 40em) { .list-disc-left { max-width: 32em; } }
.skip-link { position: absolute; clip: rect(1px, 1px, 1px, 1px); clip-path: inset(50%); width: 1px; height: 1px; overflow: hidden; white-space: nowrap; }
.skip-link:focus, .skip-link:focus-visible {
  clip: auto; clip-path: none; width: auto; height: auto; overflow: visible; padding: var(--space-2) var(--space-3);
  background: var(--text-strong); color: var(--nav-link); border-radius: var(--radius-small); z-index: 9999;
  top: max(env(safe-area-inset-top), 1em); left: max(env(safe-area-inset-left), 1em);
  text-decoration: underline; box-shadow: 0 0.25em 0.5em rgba(0,0,0,0.2);
}

/* =====================================================================
   06. THEMES & OVERRIDES
   ===================================================================== */
html[data-theme="dark"] {
  --gradient-start: #191550; --gradient-mid: #2e2761; --gradient-end: #2B245A;
  --text-strong: #e6edf7; --text-glow: #c8d6f2; --card-bg: #111a2b; --card-alt-bg: #121d30;
  --card-border: #1b2942; --accent-warm: #ffd166; --accent-warm-ink: #261a00; --focus-ring: #818cf8;
  color-scheme: dark;
}
html[data-theme="dark"] .card { background: var(--card-bg); border-color: var(--card-border); color: var(--text-strong); }
html[data-theme="dark"] .card:nth-of-type(even):not(.card--hero-placeholder) { background: var(--card-alt-bg); }
html[data-theme="dark"] .card h1,
html[data-theme="dark"] .card h2,
html[data-theme="dark"] .card h3 { color: inherit; }
html[data-theme="dark"] .card::after { opacity: 0.25; mix-blend-mode: soft-light; }
html[data-theme="dark"] .card--light { background: var(--light-card-bg); border-color: var(--light-card-border); color: var(--light-card-fg); color-scheme: light; }
html[data-theme="dark"] .mobile-nav:not(:is(.pushdown, [data-behavior="pushdown"])) { background: var(--card-bg); border-color: var(--card-border); }
html[data-theme="dark"] .mobile-nav a { color: var(--text-strong); }
html[data-theme="dark"] footer { background-color: var(--gradient-mid); }
html[data-theme="dark"] .badge-wrapper a { background: var(--card-bg); border-color: var(--card-border); }

@supports (padding: max(0px)) {
  .container { padding-left: max(var(--container-padding-x), env(safe-area-inset-left)); padding-right: max(var(--container-padding-x), env(safe-area-inset-right)); }
  footer { padding-left: max(var(--container-padding-x), env(safe-area-inset-left)); padding-right: max(var(--container-padding-x), env(safe-area-inset-right)); padding-bottom: max(var(--space-6), env(safe-area-inset-bottom)); }
}
@media (prefers-reduced-motion: reduce) {
  html { scroll-behavior: auto; animation: none !important; }
  *, *::before, *::after { animation-duration: 0.01ms !important; animation-iteration-count: 1 !important; transition-duration: 0.01ms !important; }
  .cloud, .card:hover, body:not(.loading) .container { /* animation disabled on swaps; see first-load scope below */ }
}
@media (prefers-contrast: high) {
  .card, .hamburger { border-width: 0.125em; }
  .logo img { filter: none; }
  .theme-toggle__slider, .theme-toggle__thumb { border-width: 0.1875em; }
  .card::after { display: none; }
}
@media (forced-colors: active) {
  .skip-link:focus-visible { forced-color-adjust: none; background: CanvasText; color: Canvas; }
  .top-nav a::before, .mobile-nav a::before { display: none !important; }
}
@media print {
  body { background: none; color: #000; }
  .clouds, .theme-toggle, .hamburger, .mobile-nav, .top-header, footer { display: none !important; }
  .card { box-shadow: none; border: 1px solid #000; }
  .card::after { display: none; }
  .hero-headline { color: #000 !important; text-shadow: none !important; }
  a[href]::after { content: " (" attr(href) ")"; font-size: 0.875em; }
}

/* =====================================================================
   07. TURBO INTEGRATION (disable scroll/animations during page swaps)
   ===================================================================== */
html.turbo-scroll { scroll-behavior: auto !important; }
body.turbo-swapping .container { animation: none !important; transform: none !important; }


/* =====================================================================
   08. FORMS (Contact + shared)
   - Integrated from contact page inline styles; adjusted to site tokens.
   ===================================================================== */
.visually-hidden {
  position: absolute !important;
  width: 1px; height: 1px;
  margin: -1px; padding: 0; border: 0;
  clip: rect(0 0 0 0); clip-path: inset(50%);
  overflow: hidden; white-space: nowrap;
}

.form-error { color: #b00020; margin-top: 0.25rem; }

/* Base form element styling */
/* a11y helper */
    .visually-hidden {
      position: absolute !important;
      width: 1px; height: 1px;
      margin: -1px; padding: 0; border: 0;
      clip: rect(0 0 0 0); clip-path: inset(50%);
      overflow: hidden; white-space: nowrap;
    }
    .form-error { color: #b00020; margin-top: 0.25rem; }

    /* Form styling (consolidated for maintainability) */
    label { display:block; margin-top: var(--space-3); font-weight: 400; }
    .input, .textarea {
      width: 100%;
      padding: 1rem;
      margin-top: 0.5rem;
      border-radius: 12px;
      border: 1px solid rgba(0,0,0,.15);
      background: rgba(255,255,255,.7);
    }
    [data-theme="dark"] .input, [data-theme="dark"] .textarea {
      background: rgba(0,0,0,.3);
      border-color: rgba(255,255,255,.2);
    }
    .btn {
      padding: 0.75rem 1.5rem;
      border: none;
      border-radius: 16px;
      background: #4891c3;
      color: #fff;
      font-size: 1rem;
      cursor: pointer;
      margin-top: 1rem;
    }

    /* Respect reduced-motion preferences */
    @media (prefers-reduced-motion: reduce) {
      .clouds img { animation: none !important; }
    }

/* Reduced-motion: hard-disable cloud image animation just in case */
@media (prefers-reduced-motion: reduce) {
  .clouds img { animation: none !important; }
}


/* iPad overlay: lock positioning with CSS variables so stacking changes won't move it */
.ipad-embed {
  /* defaults derived from iPad.png */
  --screen-left: 12.25%;
  --screen-top: 2.444444%;
  --screen-width: 75.5%;
  --screen-height: 95.111111%;
  --nudge-x: 0;
  --nudge-y: 0;
  --scale: 1.000;
}
.ipad-screen {
  left: var(--screen-left);
  top: var(--screen-top);
  width: var(--screen-width);
  height: var(--screen-height);
  transform-origin: top left;
  transform: translate(var(--nudge-x), var(--nudge-y)) scale(var(--scale));
  object-fit: contain; /* preserve AR; bezel sits above */
}



/* iPad overlay: bezel above video */
.ipad-embed { position: relative; }
.ipad-bezel  { position: relative; z-index: 2; pointer-events: none;
  filter: drop-shadow(0 22px 28px rgba(0,0,0,.36)) drop-shadow(0 10px 18px rgba(0,0,0,.28));
}
.ipad-screen { position: absolute; z-index: 1; }
/* iPad overlay tuning for homepage only (apply with class="ipad-embed tuned") */
.ipad-embed.tuned { --nudge-x: 0.18%; --nudge-y: 0.12%; --scale: 1.000; }


/* Homepage: extra space under the iPad animation */
.ipad-embed.tuned { margin-block-end: var(--ipad-gap-bottom, 2rem); }



/* =====================================================================
   HOW‑TO VIDEO (single file target)
   Apply radius + shadow ONLY to the video that contains
   `assets/img/animation/howto-720-cropped.webm`. Other videos unaffected.
   ===================================================================== */
video:has(> source[src$="howto-720-cropped.webm"]) {
  display: block;
  width: 100%;
  margin-inline: auto;
  border-radius: var(--radius-card);
  box-shadow: var(--shadow-1);
  background: #000;
  
  margin-block-end: 2em;
  margin-bottom: 2em;
}

@media (min-width: 64em) {
  video:has(> source[src$="howto-720-cropped.webm"]) { width: 75%; }
}


/* Cookie banner: ensure buttons above the text (robust to markup order) */
.cookie-banner__inner {
  margin-inline: auto;
  width: min(var(--content-max), 95%); flex-direction: column; }
.cookie-banner__actions { order: -1; }
.cookie-banner__inner p { order: 0; margin: 0;   color: #FFFCF5 !important;
}

/* ===== Cookie banner (authoritative, rebased) ===== */
#cookie-banner.cookie-banner,
.cookie-banner {
  position: fixed !important;
  left: 0; right: 0; bottom: 0;
  z-index: 2147483647 !important;
  width: 100%;
  margin: 0;
  /* Footer-matching gradient */
  background-image: linear-gradient(to bottom, var(--gradient-end), #1a1747) !important;
  border-top: 1px solid rgba(0,0,0,0.15);
  box-shadow: 0 -8px 24px rgba(0,0,0,0.18);
 color: #FFFCF5 !important; }

.cookie-banner__inner {
  margin-inline: auto; 
  max-width: min(var(--content-max), 95%);
  margin: 0 auto;
  padding: var(--space-3, .75rem) var(--container-padding-x, 1rem);
  display: flex;
  flex-direction: column;   /* text beneath actions */
  align-items: center;
  gap: var(--space-3, .75rem);
  text-align: center;
}

/* Buttons row above the text */
.cookie-banner__actions { 
  order: -1; 
  display: flex; 
  flex-wrap: wrap; 
  justify-content: center; 
  align-items: center; 
  gap: 0.75rem; 
}

.cookie-banner__inner p { order: 0; margin: 0;   color: #FFFCF5 !important;
}

/* Slightly darker buttons inside the banner only */
.cookie-banner .btn {
  background: var(--btn-primary-bg);
  border-color: var(--btn-primary-bg);
  color: #fff;
  filter: brightness(0.88);
}
.cookie-banner .btn:hover,
.cookie-banner .btn:focus-visible { filter: brightness(0.82); }

/* Dark theme text contrast (inherits your tokens) */
html[data-theme="dark"] .cookie-banner {
  color: #FFFCF5 !important; color: #FFFCF5 !important; border-top-color: var(--card-border); }

/* === Cookie banner: authoritative placement & layout === */
#cookie-banner.cookie-banner,
.cookie-banner {
  position: fixed !important;
  left: 0; right: 0; bottom: 0;
  z-index: 2147483647 !important;
  width: 100%;
  margin: 0;
  /* Match footer gradient */
  background-image: linear-gradient(to bottom, var(--gradient-end), #1a1747) !important;
  border-top: 1px solid rgba(0,0,0,0.15);
  box-shadow: 0 -8px 24px rgba(0,0,0,0.18);
 color: #FFFCF5 !important; }

.cookie-banner__inner {
  margin-inline: auto;
  max-width: min(var(--content-max), 95%);
  margin: 0 auto;
  display: flex;
  flex-direction: column;      /* buttons on top, text below */
  align-items: center;
  gap: var(--space-3, 0.75rem);
  text-align: center;
}

.cookie-banner__actions {
  order: -1;                   /* render buttons first regardless of DOM order */
  display: flex;
  justify-content: center;
  align-items: center;
  gap: 0.75rem;
  flex-wrap: wrap;
}

.cookie-banner .btn {
  background: var(--btn-primary-bg);
  border-color: var(--btn-primary-bg);
  color: #fff;
  filter: brightness(0.88);
}
.cookie-banner .btn:hover,
.cookie-banner .btn:focus-visible { filter: brightness(0.82); }

/* ===== Cookies page CTA (centered + white text) ===== */
#manage-cookies.centered-cta { text-align: center; }
#manage-cookies .btn {
  display: inline-block;
  margin: 0 auto;
  background: var(--gradient-start);
  border-color: var(--gradient-start);
  color: #ffffff;
}

/* ===== Consent banner buttons (restore backgrounds + fallbacks) ===== */
.cookie-banner .btn {
  background: var(--btn-primary-bg, var(--gradient-start));
  border-color: var(--btn-primary-bg, var(--gradient-start));
  color: #ffffff;
  filter: brightness(0.88);
}
.cookie-banner .btn:hover,
.cookie-banner .btn:focus-visible { filter: brightness(0.82); }

